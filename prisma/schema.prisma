generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Pengguna {
  id                String              @id @default(auto()) @map("_id") @db.ObjectId
  nama              String
  email             String              @unique
  kataSandi         String
  alamat            String
  nomortelepon      String
  gambar            String?
  peran             PeranPengguna       @default(PENGGUNA)
  jurusan           Jurusan
  lamaran           Lamaran[]
  lowonganTersimpan LowonganTersimpan[] // Menambahkan field relasi
}

model LowonganTersimpan {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  pekerjaan   Pekerjaan @relation(fields: [pekerjaanId], references: [id])
  pekerjaanId String    @db.ObjectId
  pengguna    Pengguna  @relation(fields: [penggunaId], references: [id])
  penggunaId  String    @db.ObjectId
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Pekerjaan {
  id                String              @id @default(auto()) @map("_id") @db.ObjectId
  judul             String
  namaPT            String
  deskripsi         String
  persyaratan       String[]
  openrekrutmen     String[]
  gambar            String?
  alamat            String
  email             String
  nomorTelepon      String
  lamaran           Lamaran[]
  lowonganTersimpan LowonganTersimpan[]
}

model Lamaran {
  id            String        @id @default(auto()) @map("_id") @db.ObjectId
  penggunaId    String        @db.ObjectId
  pekerjaanId   String        @db.ObjectId
  pengguna      Pengguna      @relation(fields: [penggunaId], references: [id])
  pekerjaan     Pekerjaan     @relation(fields: [pekerjaanId], references: [id])
  status        StatusLamaran @default(DIPROSES)
  tanggalDibuat DateTime      @default(now())
}

enum PeranPengguna {
  ADMIN
  PENGGUNA
  PERUSAHAAN
}

enum StatusLamaran {
  DIPROSES
  DITERIMA
  DITOLAK
}

enum Jurusan {
  PERHOTELAN
  TBSM
  TKR
}
